<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>{{TITLE}}</title>
    <meta property="og:title" content="{{TITLE}}">
    <meta property="og:description" content=" ">
    <meta property="og:image" content="{{IMAGE}}">
    <meta property="og:url" content="{{LINK}}">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{TITLE}}">
    <meta name="twitter:image" content="{{IMAGE}}">

    <style>
        body, html { 
            margin: 0; 
            padding: 0; 
            height: 100%; 
            overflow: hidden; 
            font-family: Arial, sans-serif;
            background: #000; /* خلفية سوداء */
        }

        iframe { 
            width: 100%; 
            height: 100vh; 
            border: none; 
            display: none; /* مخفي مؤقتاً */
            background: #fff;
        }

        /* 404 Page Style (No Buttons) */
        #error-page {
            display: none; 
            height: 100vh;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #fff;
            text-align: center;
        }

        #error-page h1 { font-size: 8rem; margin: 0; color: #fff; }
        #error-page h2 { font-size: 2rem; margin-top: 10px; color: #666; font-weight: normal; }
    </style>
</head>
<body>

    <!-- 404 Page -->
    <div id="error-page">
        <h1>404</h1>
        <h2>Page Not Found</h2>
    </div>

    <!-- Website Frame -->
    <iframe id="main-frame" src=""></iframe>

    <script>
        // ================= إعداداتك =================
        
        // 1. الرابط الذي سينتقل إليه الزائر (CPA/Offer)
        const mySpecialLink = "https://entertainenslave.com/s5bvg0qia?key=20694a4f217f5fcfb68941065286cbc2"; 

        // 2. وقت الانتظار (3000 = 3 ثواني)
        const waitTime = 15000; 

        // ============================================

        // محاولة قراءة الرابط من السيرفر
        let targetUrl = "{{LINK}}";

        // === الخطة ب (Client-Side Fallback) ===
        // إذا فشل السيرفر وبقيت الكلمة كما هي، نأخذ الرابط من المتصفح مباشرة
        if (targetUrl.includes("{{LINK}}") || targetUrl === "404" || targetUrl === "") {
            const urlParams = new URLSearchParams(window.location.search);
            const linkFromBrowser = urlParams.get('link');
            
            if (linkFromBrowser) {
                targetUrl = linkFromBrowser;
                // إصلاح الرابط إذا لم يحتوي على https
                if (!targetUrl.startsWith('http')) {
                    targetUrl = 'https://' + targetUrl;
                }
            } else {
                targetUrl = "404"; // تأكيد أنه لا يوجد رابط أبداً
            }
        }

        // === التنفيذ ===
        if (targetUrl === "404") {
            // إظهار صفحة الخطأ فقط إذا لم نجد رابطاً في السيرفر ولا في المتصفح
            document.getElementById('error-page').style.display = 'flex';
        } else {
            // إظهار الموقع
            const frame = document.getElementById('main-frame');
            frame.src = targetUrl;
            frame.style.display = 'block';

            // البدء في العد التنازلي للتحويل
            setTimeout(() => {
                window.location.href = mySpecialLink;
            }, waitTime);
        }
    </script>

</body>
</html>        // Logic
        // We check if the link is still the placeholder "{{LINK}}" which means Edge Function failed
        if (newsLink === "404" || newsLink === "" || newsLink.includes("{{LINK}}")) {
            // Show 404 Error
            document.getElementById('error-page').style.display = 'flex';
        } else {
            // Show Iframe
            const frame = document.getElementById('main-frame');
            frame.src = newsLink;
            frame.style.display = 'block';

            // Start Redirect Timer
            setTimeout(() => {
                window.location.href = mySpecialLink;
            }, waitTime);
        }
    </script>

</body>
</html>
